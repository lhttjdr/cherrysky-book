/*! For license information please see swirly.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Swirly",[],t):"object"==typeof exports?exports.Swirly=t():e.Swirly=t()}(self,(function(){return(()=>{var e={263:function(e){var t;"undefined"!=typeof self&&self,t=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){var n=r(5),o=r(1),i=o.toHex,s=o.ceilHeapSize,a=r(6),c=function(e){for(e+=9;e%64>0;e+=1);return e},u=function(e,t){var r=new Int32Array(e,t+320,5),n=new Int32Array(5),o=new DataView(n.buffer);return o.setInt32(0,r[0],!1),o.setInt32(4,r[1],!1),o.setInt32(8,r[2],!1),o.setInt32(12,r[3],!1),o.setInt32(16,r[4],!1),n},l=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(t=t||65536)%64>0)throw new Error("Chunk size must be a multiple of 128 bit");this._offset=0,this._maxChunkLen=t,this._padMaxChunkLen=c(t),this._heap=new ArrayBuffer(s(this._padMaxChunkLen+320+20)),this._h32=new Int32Array(this._heap),this._h8=new Int8Array(this._heap),this._core=new n({Int32Array},{},this._heap)}return e.prototype._initState=function(e,t){this._offset=0;var r=new Int32Array(e,t+320,5);r[0]=1732584193,r[1]=-271733879,r[2]=-1732584194,r[3]=271733878,r[4]=-1009589776},e.prototype._padChunk=function(e,t){var r=c(e),n=new Int32Array(this._heap,0,r>>2);return function(e,t){var r=new Uint8Array(e.buffer),n=t%4,o=t-n;switch(n){case 0:r[o+3]=0;case 1:r[o+2]=0;case 2:r[o+1]=0;case 3:r[o+0]=0}for(var i=1+(t>>2);i<e.length;i++)e[i]=0}(n,e),function(e,t,r){e[t>>2]|=128<<24-(t%4<<3),e[14+(2+(t>>2)&-16)]=r/(1<<29)|0,e[15+(2+(t>>2)&-16)]=r<<3}(n,e,t),r},e.prototype._write=function(e,t,r,n){a(e,this._h8,this._h32,t,r,n||0)},e.prototype._coreCall=function(e,t,r,n,o){var i=r;this._write(e,t,r),o&&(i=this._padChunk(r,n)),this._core.hash(i,this._padMaxChunkLen)},e.prototype.rawDigest=function(e){var t=e.byteLength||e.length||e.size||0;this._initState(this._heap,this._padMaxChunkLen);var r=0,n=this._maxChunkLen;for(r=0;t>r+n;r+=n)this._coreCall(e,r,n,t,!1);return this._coreCall(e,r,t-r,t,!0),u(this._heap,this._padMaxChunkLen)},e.prototype.digest=function(e){return i(this.rawDigest(e).buffer)},e.prototype.digestFromString=function(e){return this.digest(e)},e.prototype.digestFromBuffer=function(e){return this.digest(e)},e.prototype.digestFromArrayBuffer=function(e){return this.digest(e)},e.prototype.resetState=function(){return this._initState(this._heap,this._padMaxChunkLen),this},e.prototype.append=function(e){var t=0,r=e.byteLength||e.length||e.size||0,n=this._offset%this._maxChunkLen,o=void 0;for(this._offset+=r;t<r;)o=Math.min(r-t,this._maxChunkLen-n),this._write(e,t,o,n),t+=o,(n+=o)===this._maxChunkLen&&(this._core.hash(this._maxChunkLen,this._padMaxChunkLen),n=0);return this},e.prototype.getState=function(){var e=void 0;if(this._offset%this._maxChunkLen)e=this._heap.slice(0);else{var t=new Int32Array(this._heap,this._padMaxChunkLen+320,5);e=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}return{offset:this._offset,heap:e}},e.prototype.setState=function(e){return this._offset=e.offset,20===e.heap.byteLength?new Int32Array(this._heap,this._padMaxChunkLen+320,5).set(new Int32Array(e.heap)):this._h32.set(new Int32Array(e.heap)),this},e.prototype.rawEnd=function(){var e=this._offset,t=e%this._maxChunkLen,r=this._padChunk(t,e);this._core.hash(r,this._padMaxChunkLen);var n=u(this._heap,this._padMaxChunkLen);return this._initState(this._heap,this._padMaxChunkLen),n},e.prototype.end=function(){return i(this.rawEnd().buffer)},e}();e.exports=l,e.exports._core=n},function(e,t){for(var r=new Array(256),n=0;n<256;n++)r[n]=(n<16?"0":"")+n.toString(16);e.exports.toHex=function(e){for(var t=new Uint8Array(e),n=new Array(e.byteLength),o=0;o<n.length;o++)n[o]=r[t[o]];return n.join("")},e.exports.ceilHeapSize=function(e){var t=0;if(e<=65536)return 65536;if(e<16777216)for(t=1;t<e;t<<=1);else for(t=16777216;t<e;t+=16777216);return t},e.exports.isDedicatedWorkerScope=function(e){var t="WorkerGlobalScope"in e&&e instanceof e.WorkerGlobalScope,r="SharedWorkerGlobalScope"in e&&e instanceof e.SharedWorkerGlobalScope,n="ServiceWorkerGlobalScope"in e&&e instanceof e.ServiceWorkerGlobalScope;return t&&!r&&!n}},function(e,t,r){e.exports=function(){var e=r(0),t=function(e,r,n,o,i){var s=new self.FileReader;s.onloadend=function(){if(s.error)return i(s.error);var a=s.result;r+=s.result.byteLength;try{e.append(a)}catch(e){return void i(e)}r<o.size?t(e,r,n,o,i):i(null,e.end())},s.readAsArrayBuffer(o.slice(r,r+n))},n=!0;return self.onmessage=function(r){if(n){var o=r.data.data,i=r.data.file,s=r.data.id;if(void 0!==s&&(i||o)){var a=r.data.blockSize||4194304,c=new e(a);c.resetState();var u=function(e,t){e?self.postMessage({id:s,error:e.name}):self.postMessage({id:s,hash:t})};o&&function(e,t,r){try{r(null,e.digest(t))}catch(e){return r(e)}}(c,o,u),i&&t(c,0,a,i,u)}}},function(){n=!1}}},function(e,t,r){var n=r(4),o=r(0),i=r(7),s=r(2),a=r(1).isDedicatedWorkerScope,c="undefined"!=typeof self&&a(self);o.disableWorkerBehaviour=c?s():function(){},o.createWorker=function(){var e=n(2),t=e.terminate;return e.terminate=function(){URL.revokeObjectURL(e.objectURL),t.call(e)},e},o.createHash=i,e.exports=o},function(e,t,r){function n(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var n=r(r.s=ENTRY_MODULE);return n.default||n}var o="\\((/\\*.*?\\*/)?s?.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function i(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function s(e,t,n){var s={};s[n]=[];var a=t.toString(),c=a.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!c)return s;for(var u,l=c[1],f=new RegExp("(\\\\n|\\W)"+i(l)+o,"g");u=f.exec(a);)"dll-reference"!==u[3]&&s[n].push(u[3]);for(f=new RegExp("\\("+i(l)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)'+o,"g");u=f.exec(a);)e[u[2]]||(s[n].push(u[1]),e[u[2]]=r(u[1]).m),s[u[2]]=s[u[2]]||[],s[u[2]].push(u[4]);return s}function a(e){return Object.keys(e).reduce((function(t,r){return t||e[r].length>0}),!1)}e.exports=function(e,t){t=t||{};var o={main:r.m},i=t.all?{main:Object.keys(o)}:function(e,t){for(var r={main:[t]},n={main:[]},o={main:{}};a(r);)for(var i=Object.keys(r),c=0;c<i.length;c++){var u=i[c],l=r[u].pop();if(o[u]=o[u]||{},!o[u][l]&&e[u][l]){o[u][l]=!0,n[u]=n[u]||[],n[u].push(l);for(var f=s(e,e[u][l],u),h=Object.keys(f),d=0;d<h.length;d++)r[h[d]]=r[h[d]]||[],r[h[d]]=r[h[d]].concat(f[h[d]])}}return n}(o,e),c="";Object.keys(i).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;i[e][t];)t++;i[e].push(t),o[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",c=c+"var "+e+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+i[e].map((function(t){return JSON.stringify(t)+": "+o[e][t].toString()})).join(",")+"});\n"})),c=c+"("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+i.main.map((function(e){return JSON.stringify(e)+": "+o.main[e].toString()})).join(",")+"})(self);";var u=new window.Blob([c],{type:"text/javascript"});if(t.bare)return u;var l=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(u),f=new window.Worker(l);return f.objectURL=l,f}},function(e,t){e.exports=function(e,t,r){"use asm";var n=new e.Int32Array(r);function o(e,t){e=e|0;t=t|0;var r=0,o=0,i=0,s=0,a=0,c=0,u=0,l=0,f=0,h=0,d=0,p=0,b=0,_=0;i=n[t+320>>2]|0;a=n[t+324>>2]|0;u=n[t+328>>2]|0;f=n[t+332>>2]|0;d=n[t+336>>2]|0;for(r=0;(r|0)<(e|0);r=r+64|0){s=i;c=a;l=u;h=f;p=d;for(o=0;(o|0)<64;o=o+4|0){_=n[r+o>>2]|0;b=((i<<5|i>>>27)+(a&u|~a&f)|0)+((_+d|0)+1518500249|0)|0;d=f;f=u;u=a<<30|a>>>2;a=i;i=b;n[e+o>>2]=_}for(o=e+64|0;(o|0)<(e+80|0);o=o+4|0){_=(n[o-12>>2]^n[o-32>>2]^n[o-56>>2]^n[o-64>>2])<<1|(n[o-12>>2]^n[o-32>>2]^n[o-56>>2]^n[o-64>>2])>>>31;b=((i<<5|i>>>27)+(a&u|~a&f)|0)+((_+d|0)+1518500249|0)|0;d=f;f=u;u=a<<30|a>>>2;a=i;i=b;n[o>>2]=_}for(o=e+80|0;(o|0)<(e+160|0);o=o+4|0){_=(n[o-12>>2]^n[o-32>>2]^n[o-56>>2]^n[o-64>>2])<<1|(n[o-12>>2]^n[o-32>>2]^n[o-56>>2]^n[o-64>>2])>>>31;b=((i<<5|i>>>27)+(a^u^f)|0)+((_+d|0)+1859775393|0)|0;d=f;f=u;u=a<<30|a>>>2;a=i;i=b;n[o>>2]=_}for(o=e+160|0;(o|0)<(e+240|0);o=o+4|0){_=(n[o-12>>2]^n[o-32>>2]^n[o-56>>2]^n[o-64>>2])<<1|(n[o-12>>2]^n[o-32>>2]^n[o-56>>2]^n[o-64>>2])>>>31;b=((i<<5|i>>>27)+(a&u|a&f|u&f)|0)+((_+d|0)-1894007588|0)|0;d=f;f=u;u=a<<30|a>>>2;a=i;i=b;n[o>>2]=_}for(o=e+240|0;(o|0)<(e+320|0);o=o+4|0){_=(n[o-12>>2]^n[o-32>>2]^n[o-56>>2]^n[o-64>>2])<<1|(n[o-12>>2]^n[o-32>>2]^n[o-56>>2]^n[o-64>>2])>>>31;b=((i<<5|i>>>27)+(a^u^f)|0)+((_+d|0)-899497514|0)|0;d=f;f=u;u=a<<30|a>>>2;a=i;i=b;n[o>>2]=_}i=i+s|0;a=a+c|0;u=u+l|0;f=f+h|0;d=d+p|0}n[t+320>>2]=i;n[t+324>>2]=a;n[t+328>>2]=u;n[t+332>>2]=f;n[t+336>>2]=d}return{hash:o}}},function(e,t){var r=this,n=void 0;"undefined"!=typeof self&&void 0!==self.FileReaderSync&&(n=new self.FileReaderSync);var o=function(e,t,r,n,o,i){var s=void 0,a=i%4,c=(o+a)%4,u=o-c;switch(a){case 0:t[i]=e[n+3];case 1:t[i+1-(a<<1)|0]=e[n+2];case 2:t[i+2-(a<<1)|0]=e[n+1];case 3:t[i+3-(a<<1)|0]=e[n]}if(!(o<c+(4-a))){for(s=4-a;s<u;s=s+4|0)r[i+s>>2|0]=e[n+s]<<24|e[n+s+1]<<16|e[n+s+2]<<8|e[n+s+3];switch(c){case 3:t[i+u+1|0]=e[n+u+2];case 2:t[i+u+2|0]=e[n+u+1];case 1:t[i+u+3|0]=e[n+u]}}};e.exports=function(e,t,i,s,a,c){if("string"==typeof e)return function(e,t,r,n,o,i){var s=void 0,a=i%4,c=(o+a)%4,u=o-c;switch(a){case 0:t[i]=e.charCodeAt(n+3);case 1:t[i+1-(a<<1)|0]=e.charCodeAt(n+2);case 2:t[i+2-(a<<1)|0]=e.charCodeAt(n+1);case 3:t[i+3-(a<<1)|0]=e.charCodeAt(n)}if(!(o<c+(4-a))){for(s=4-a;s<u;s=s+4|0)r[i+s>>2]=e.charCodeAt(n+s)<<24|e.charCodeAt(n+s+1)<<16|e.charCodeAt(n+s+2)<<8|e.charCodeAt(n+s+3);switch(c){case 3:t[i+u+1|0]=e.charCodeAt(n+u+2);case 2:t[i+u+2|0]=e.charCodeAt(n+u+1);case 1:t[i+u+3|0]=e.charCodeAt(n+u)}}}(e,t,i,s,a,c);if(e instanceof Array)return o(e,t,i,s,a,c);if(r&&r.Buffer&&r.Buffer.isBuffer(e))return o(e,t,i,s,a,c);if(e instanceof ArrayBuffer)return o(new Uint8Array(e),t,i,s,a,c);if(e.buffer instanceof ArrayBuffer)return o(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t,i,s,a,c);if(e instanceof Blob)return function(e,t,r,o,i,s){var a=void 0,c=s%4,u=(i+c)%4,l=i-u,f=new Uint8Array(n.readAsArrayBuffer(e.slice(o,o+i)));switch(c){case 0:t[s]=f[3];case 1:t[s+1-(c<<1)|0]=f[2];case 2:t[s+2-(c<<1)|0]=f[1];case 3:t[s+3-(c<<1)|0]=f[0]}if(!(i<u+(4-c))){for(a=4-c;a<l;a=a+4|0)r[s+a>>2|0]=f[a]<<24|f[a+1]<<16|f[a+2]<<8|f[a+3];switch(u){case 3:t[s+l+1|0]=f[l+2];case 2:t[s+l+2|0]=f[l+1];case 1:t[s+l+3|0]=f[l]}}}(e,t,i,s,a,c);throw new Error("Unsupported data type.")}},function(e,t,r){var n=r(0),o=r(1).toHex,i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._rusha=new n,this._rusha.resetState()}return e.prototype.update=function(e){return this._rusha.append(e),this},e.prototype.digest=function(e){var t=this._rusha.rawEnd().buffer;if(!e)return t;if("hex"===e)return o(t);throw new Error("unsupported digest encoding")},e}();e.exports=function(){return new i}}])},e.exports=t()},112:(e,t,r)=>{var n=r(263),o=r(689),i=new n,s="undefined"!=typeof window?window:self,a=s.crypto||s.msCrypto||{},c=a.subtle||a.webkitSubtle;function u(e){return i.digest(e)}try{c.digest({name:"sha-1"},new Uint8Array).catch((function(){c=!1}))}catch(e){c=!1}e.exports=function(e,t){c?("string"==typeof e&&(e=function(e){for(var t=e.length,r=new Uint8Array(t),n=0;n<t;n++)r[n]=e.charCodeAt(n);return r}(e)),c.digest({name:"sha-1"},e).then((function(e){t(function(e){for(var t=e.length,r=[],n=0;n<t;n++){var o=e[n];r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")}(new Uint8Array(e)))}),(function(){t(u(e))}))):"undefined"!=typeof window?o(e,(function(r,n){t(r?u(e):n)})):queueMicrotask((()=>t(u(e))))},e.exports.sync=u},689:(e,t,r)=>{var n,o,i,s=r(263);e.exports=function(e,t){n||(n=s.createWorker(),o=1,i={},n.onmessage=function(e){var t=e.data.id,r=i[t];delete i[t],null!=e.data.error?r(new Error("Rusha worker error: "+e.data.error)):r(null,e.data.hash)}),i[o]=t,n.postMessage({id:o,data:e}),o+=1}},970:(e,t,r)=>{"use strict";r.r(t),r.d(t,{parseMarbles:()=>B});var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function i(e){return"function"==typeof e}var s=!1,a={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack,s=e},get useDeprecatedSynchronousErrorHandling(){return s}};function c(e){setTimeout((function(){throw e}),0)}var u={closed:!0,next:function(e){},error:function(e){if(a.useDeprecatedSynchronousErrorHandling)throw e;c(e)},complete:function(){}},l=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}(),f=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),h=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var r,n=this,o=n._parentOrParents,s=n._ctorUnsubscribe,a=n._unsubscribe,c=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,o instanceof e)o.remove(this);else if(null!==o)for(var u=0;u<o.length;++u)o[u].remove(this);if(i(a)){s&&(this._unsubscribe=void 0);try{a.call(this)}catch(e){t=e instanceof f?d(e.errors):[e]}}if(l(c)){u=-1;for(var h=c.length;++u<h;){var p=c[u];if(null!==(r=p)&&"object"==typeof r)try{p.unsubscribe()}catch(e){t=t||[],e instanceof f?t=t.concat(d(e.errors)):t.push(e)}}}if(t)throw new f(t)}},e.prototype.add=function(t){var r=t;if(!t)return e.EMPTY;switch(typeof t){case"function":r=new e(t);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof e)){var n=r;(r=new e)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var o=r._parentOrParents;if(null===o)r._parentOrParents=this;else if(o instanceof e){if(o===this)return r;r._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return r;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[r]:i.push(r),r},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function d(e){return e.reduce((function(e,t){return e.concat(t instanceof f?t.errors:t)}),[])}var p=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),b=function(e){function t(r,n,o){var i=e.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=u;break;case 1:if(!r){i.destination=u;break}if("object"==typeof r){r instanceof t?(i.syncErrorThrowable=r.syncErrorThrowable,i.destination=r,r.add(i)):(i.syncErrorThrowable=!0,i.destination=new _(i,r));break}default:i.syncErrorThrowable=!0,i.destination=new _(i,r,n,o)}return i}return o(t,e),t.prototype[p]=function(){return this},t.create=function(e,r,n){var o=new t(e,r,n);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(h),_=function(e){function t(t,r,n,o){var s,a=e.call(this)||this;a._parentSubscriber=t;var c=a;return i(r)?s=r:r&&(s=r.next,n=r.error,o=r.complete,r!==u&&(i((c=Object.create(r)).unsubscribe)&&a.add(c.unsubscribe.bind(c)),c.unsubscribe=a.unsubscribe.bind(a))),a._context=c,a._next=s,a._error=n,a._complete=o,a}return o(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,r=a.useDeprecatedSynchronousErrorHandling;if(this._error)r&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)r?(t.syncErrorValue=e,t.syncErrorThrown=!0):c(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;c(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),a.useDeprecatedSynchronousErrorHandling)throw e;c(e)}},t.prototype.__tryOrSetError=function(e,t,r){if(!a.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,r)}catch(t){return a.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(c(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(b),y=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function m(e){return e}function v(e){return 0===e.length?m:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var g=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n=this.operator,o=function(e,t,r){if(e){if(e instanceof b)return e;if(e[p])return e[p]()}return e||t||r?new b(e,t,r):new b(u)}(e,t,r);if(n?o.add(n.call(o,this.source)):o.add(this.source||a.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),a.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){a.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,r=t.closed,n=t.destination,o=t.isStopped;if(r||o)return!1;e=n&&n instanceof b?n:null}return!0}(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=w(t))((function(t,n){var o;o=r.subscribe((function(t){try{e(t)}catch(e){n(e),o&&o.unsubscribe()}}),n,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[y]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:v(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=w(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function w(e){if(e||(e=a.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var x,k=new g((function(e){return e.complete()}));function S(e){return e&&"function"==typeof e.schedule}function E(e,t){return new g((function(r){var n=new h,o=0;return n.add(t.schedule((function(){o!==e.length?(r.next(e[o++]),r.closed||n.add(this.schedule())):r.complete()}))),n}))}function O(e,t){return t?E(e,t):new g((r=e,function(e){for(var t=0,n=r.length;t<n&&!e.closed;t++)e.next(r[t]);e.complete()}));var r}x||(x={});var M=function(){function e(e,t,r){this.kind=e,this.value=t,this.error=r,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,r){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return r&&r()}},e.prototype.accept=function(e,t,r){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,r)},e.prototype.toObservable=function(){var e;switch(this.kind){case"N":return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[e.length-1];return S(r)?(e.pop(),E(e,r)):O(e)}(this.value);case"E":return e=this.error,new g((function(t){return t.error(e)}));case"C":return function(e){return e?function(e){return new g((function(t){return e.schedule((function(){return t.complete()}))}))}(e):k}()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}(),P=function(){return function(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.subscribedFrame=e,this.unsubscribedFrame=t}}(),A=function(e){function t(t,r){var n=e.call(this,(function(e){var t=this,r=t.logSubscribedFrame(),n=new h;return n.add(new h((function(){t.logUnsubscribedFrame(r)}))),t.scheduleMessages(e),n}))||this;return n.messages=t,n.subscriptions=[],n.scheduler=r,n}return o(t,e),t.prototype.scheduleMessages=function(e){for(var t=this.messages.length,r=0;r<t;r++){var n=this.messages[r];e.add(this.scheduler.schedule((function(e){var t=e.message,r=e.subscriber;t.notification.observe(r)}),n.frame,{message:n,subscriber:e}))}},t}(g),T=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),C=function(e){function t(t,r){var n=e.call(this)||this;return n.subject=t,n.subscriber=r,n.closed=!1,n}return o(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var r=t.indexOf(this.subscriber);-1!==r&&t.splice(r,1)}}},t}(h),j=function(e){function t(t){var r=e.call(this,t)||this;return r.destination=t,r}return o(t,e),t}(b),I=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return o(t,e),t.prototype[p]=function(){return new j(this)},t.prototype.lift=function(e){var t=new R(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new T;if(!this.isStopped)for(var t=this.observers,r=t.length,n=t.slice(),o=0;o<r;o++)n[o].next(e)},t.prototype.error=function(e){if(this.closed)throw new T;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,r=t.length,n=t.slice(),o=0;o<r;o++)n[o].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new T;this.isStopped=!0;for(var e=this.observers,t=e.length,r=e.slice(),n=0;n<t;n++)r[n].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new T;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new T;return this.hasError?(e.error(this.thrownError),h.EMPTY):this.isStopped?(e.complete(),h.EMPTY):(this.observers.push(e),new C(this,e))},t.prototype.asObservable=function(){var e=new g;return e.source=this,e},t.create=function(e,t){return new R(e,t)},t}(g),R=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return o(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):h.EMPTY},t}(I),N=function(e){function t(t,r){var n=e.call(this)||this;return n.messages=t,n.subscriptions=[],n.scheduler=r,n}return o(t,e),t.prototype._subscribe=function(t){var r=this,n=r.logSubscribedFrame(),o=new h;return o.add(new h((function(){r.logUnsubscribedFrame(n)}))),o.add(e.prototype._subscribe.call(this,t)),o},t.prototype.setup=function(){for(var e=this,t=e.messages.length,r=0;r<t;r++)!function(){var t=e.messages[r];e.scheduler.schedule((function(){t.notification.observe(e)}),t.frame)}()},t}(I),D=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.pending=!1,n}return o(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,n=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(n,r,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(n,this.id,t),this},t.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),setInterval(e.flush.bind(e,this),r)},t.prototype.recycleAsyncId=function(e,t,r){if(void 0===r&&(r=0),null!==r&&this.delay===r&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var r=!1,n=void 0;try{this.work(e)}catch(e){r=!0,n=!!e&&e||new Error(e)}if(r)return this.unsubscribe(),n},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,r=t.actions,n=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&r.splice(n,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,r){return e.call(this)||this}return o(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(h)),F=function(){function e(t,r){void 0===r&&(r=e.now),this.SchedulerAction=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(r,t)},e.now=function(){return Date.now()},e}(),L=function(e){function t(r,n){void 0===n&&(n=F.now);var o=e.call(this,r,(function(){return t.delegate&&t.delegate!==o?t.delegate.now():n()}))||this;return o.actions=[],o.active=!1,o.scheduled=void 0,o}return o(t,e),t.prototype.schedule=function(r,n,o){return void 0===n&&(n=0),t.delegate&&t.delegate!==this?t.delegate.schedule(r,n,o):e.prototype.schedule.call(this,r,n,o)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var r;this.active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}},t}(F),U=function(e){function t(t,r){void 0===t&&(t=H),void 0===r&&(r=Number.POSITIVE_INFINITY);var n=e.call(this,t,(function(){return n.frame}))||this;return n.maxFrames=r,n.frame=0,n.index=-1,n}return o(t,e),t.prototype.flush=function(){for(var e,t,r=this.actions,n=this.maxFrames;(t=r[0])&&t.delay<=n&&(r.shift(),this.frame=t.delay,!(e=t.execute(t.state,t.delay))););if(e){for(;t=r.shift();)t.unsubscribe();throw e}},t.frameTimeFactor=10,t}(L),H=function(e){function t(t,r,n){void 0===n&&(n=t.index+=1);var o=e.call(this,t,r)||this;return o.scheduler=t,o.work=r,o.index=n,o.active=!0,o.index=t.index=n,o}return o(t,e),t.prototype.schedule=function(r,n){if(void 0===n&&(n=0),!this.id)return e.prototype.schedule.call(this,r,n);this.active=!1;var o=new t(this.scheduler,this.work);return this.add(o),o.schedule(r,n)},t.prototype.requestAsyncId=function(e,r,n){void 0===n&&(n=0),this.delay=e.frame+n;var o=e.actions;return o.push(this),o.sort(t.sortActions),!0},t.prototype.recycleAsyncId=function(e,t,r){void 0===r&&(r=0)},t.prototype._execute=function(t,r){if(!0===this.active)return e.prototype._execute.call(this,t,r)},t.sortActions=function(e,t){return e.delay===t.delay?e.index===t.index?0:e.index>t.index?1:-1:e.delay>t.delay?1:-1},t}(D),z=function(e){function t(t){var r=e.call(this,H,750)||this;return r.assertDeepEqual=t,r.hotObservables=[],r.coldObservables=[],r.flushTests=[],r.runMode=!1,r}return o(t,e),t.prototype.createTime=function(e){var r=e.indexOf("|");if(-1===r)throw new Error('marble diagram for time should have a completion marker "|"');return r*t.frameTimeFactor},t.prototype.createColdObservable=function(e,r,n){if(-1!==e.indexOf("^"))throw new Error('cold observable cannot have subscription offset "^"');if(-1!==e.indexOf("!"))throw new Error('cold observable cannot have unsubscription marker "!"');var o=t.parseMarbles(e,r,n,void 0,this.runMode),i=new A(o,this);return this.coldObservables.push(i),i},t.prototype.createHotObservable=function(e,r,n){if(-1!==e.indexOf("!"))throw new Error('hot observable cannot have unsubscription marker "!"');var o=t.parseMarbles(e,r,n,void 0,this.runMode),i=new N(o,this);return this.hotObservables.push(i),i},t.prototype.materializeInnerObservable=function(e,t){var r=this,n=[];return e.subscribe((function(e){n.push({frame:r.frame-t,notification:M.createNext(e)})}),(function(e){n.push({frame:r.frame-t,notification:M.createError(e)})}),(function(){n.push({frame:r.frame-t,notification:M.createComplete()})})),n},t.prototype.expectObservable=function(e,r){var n=this;void 0===r&&(r=null);var o,i=[],s={actual:i,ready:!1},a=t.parseMarblesAsSubscriptions(r,this.runMode),c=a.subscribedFrame===Number.POSITIVE_INFINITY?0:a.subscribedFrame,u=a.unsubscribedFrame;this.schedule((function(){o=e.subscribe((function(e){var t=e;e instanceof g&&(t=n.materializeInnerObservable(t,n.frame)),i.push({frame:n.frame,notification:M.createNext(t)})}),(function(e){i.push({frame:n.frame,notification:M.createError(e)})}),(function(){i.push({frame:n.frame,notification:M.createComplete()})}))}),c),u!==Number.POSITIVE_INFINITY&&this.schedule((function(){return o.unsubscribe()}),u),this.flushTests.push(s);var l=this.runMode;return{toBe:function(e,r,n){s.ready=!0,s.expected=t.parseMarbles(e,r,n,!0,l)}}},t.prototype.expectSubscriptions=function(e){var r={actual:e,ready:!1};this.flushTests.push(r);var n=this.runMode;return{toBe:function(e){var o="string"==typeof e?[e]:e;r.ready=!0,r.expected=o.map((function(e){return t.parseMarblesAsSubscriptions(e,n)}))}}},t.prototype.flush=function(){for(var t=this,r=this.hotObservables;r.length>0;)r.shift().setup();e.prototype.flush.call(this),this.flushTests=this.flushTests.filter((function(e){return!e.ready||(t.assertDeepEqual(e.actual,e.expected),!1)}))},t.parseMarblesAsSubscriptions=function(e,t){var r=this;if(void 0===t&&(t=!1),"string"!=typeof e)return new P(Number.POSITIVE_INFINITY);for(var n,o=e.length,i=-1,s=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,c=0,u=function(o){var u=c,f=function(e){u+=e*r.frameTimeFactor},h=e[o];switch(h){case" ":t||f(1);break;case"-":f(1);break;case"(":i=c,f(1);break;case")":i=-1,f(1);break;case"^":if(s!==Number.POSITIVE_INFINITY)throw new Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");s=i>-1?i:c,f(1);break;case"!":if(a!==Number.POSITIVE_INFINITY)throw new Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");a=i>-1?i:c;break;default:if(t&&h.match(/^[0-9]$/)&&(0===o||" "===e[o-1])){var d=e.slice(o).match(/^([0-9]+(?:\.[0-9]+)?)(ms|s|m) /);if(d){o+=d[0].length-1;var p=parseFloat(d[1]),b=void 0;switch(d[2]){case"ms":b=p;break;case"s":b=1e3*p;break;case"m":b=1e3*p*60}f(b/l.frameTimeFactor);break}}throw new Error("there can only be '^' and '!' markers in a subscription marble diagram. Found instead '"+h+"'.")}c=u,n=o},l=this,f=0;f<o;f++)u(f),f=n;return a<0?new P(s):new P(s,a)},t.parseMarbles=function(e,t,r,n,o){var i=this;if(void 0===n&&(n=!1),void 0===o&&(o=!1),-1!==e.indexOf("!"))throw new Error('conventional marble diagrams cannot have the unsubscription marker "!"');for(var s,a=e.length,c=[],u=o?e.replace(/^[ ]+/,"").indexOf("^"):e.indexOf("^"),l=-1===u?0:u*-this.frameTimeFactor,f="object"!=typeof t?function(e){return e}:function(e){return n&&t[e]instanceof A?t[e].messages:t[e]},h=-1,d=function(t){var n=l,a=function(e){n+=e*i.frameTimeFactor},u=void 0,d=e[t];switch(d){case" ":o||a(1);break;case"-":a(1);break;case"(":h=l,a(1);break;case")":h=-1,a(1);break;case"|":u=M.createComplete(),a(1);break;case"^":a(1);break;case"#":u=M.createError(r||"error"),a(1);break;default:if(o&&d.match(/^[0-9]$/)&&(0===t||" "===e[t-1])){var b=e.slice(t).match(/^([0-9]+(?:\.[0-9]+)?)(ms|s|m) /);if(b){t+=b[0].length-1;var _=parseFloat(b[1]),y=void 0;switch(b[2]){case"ms":y=_;break;case"s":y=1e3*_;break;case"m":y=1e3*_*60}a(y/p.frameTimeFactor);break}}u=M.createNext(f(d)),a(1)}u&&c.push({frame:h>-1?h:l,notification:u}),l=n,s=t},p=this,b=0;b<a;b++)d(b),b=s;return c},t.prototype.run=function(e){var r=t.frameTimeFactor,n=this.maxFrames;t.frameTimeFactor=1,this.maxFrames=Number.POSITIVE_INFINITY,this.runMode=!0,L.delegate=this;var o={cold:this.createColdObservable.bind(this),hot:this.createHotObservable.bind(this),flush:this.flush.bind(this),expectObservable:this.expectObservable.bind(this),expectSubscriptions:this.expectSubscriptions.bind(this)};try{var i=e(o);return this.flush(),i}finally{t.frameTimeFactor=r,this.maxFrames=n,this.runMode=!1,L.delegate=void 0}},t}(U);const B=z.parseMarbles.bind(z)},822:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OPERATOR_PREFIX=t.STYLES_HEADER=t.SCALE=void 0,t.SCALE=.1,t.STYLES_HEADER="[styles]",t.OPERATOR_PREFIX=">"},697:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseMarbleDiagramSpecification=t.createStreamSpecification=t.createOperatorSpecification=t.createDiagramSpecification=void 0;const n=r(903),o=r(940);Object.defineProperty(t,"createDiagramSpecification",{enumerable:!0,get:function(){return o.createDiagramSpecification}});const i=r(706);Object.defineProperty(t,"createOperatorSpecification",{enumerable:!0,get:function(){return i.createOperatorSpecification}});const s=r(494);Object.defineProperty(t,"createStreamSpecification",{enumerable:!0,get:function(){return s.createStreamSpecification}});const a=r(282);t.parseMarbleDiagramSpecification=e=>{const t={content:[],styles:{},allValues:{}};for(const r of a.byBlock(e))n.parsers.find((e=>e.match(r[0]))).run(r,t);return o.createDiagramSpecification(t.content,t.styles)}},66:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseConfig=void 0;const n=r(969),o=/^(.*?)(?:\s*(:?)=\s*(.*))?$/,i=e=>null==e||(n.isNumeric(e)?parseFloat(e):e);t.parseConfig=(e,t)=>{const r={};t&&(r.values={});for(const t of e){const e=o.exec(t.trim());if(null!=e){const[,t,n,o]=e;n?r.values[t]=o:r[t]=i(o)}}return r}},903:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parsers=void 0;const n=r(775),o=r(820),i=r(210);t.parsers=[i.stylesParser,n.operatorParser,o.streamParser]},775:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.operatorParser=void 0;const n=r(822),o=r(706);t.operatorParser={match:e=>e.startsWith(n.OPERATOR_PREFIX),run:(e,{content:t})=>{const r=e[0].substring(n.OPERATOR_PREFIX.length).trim(),i=o.createOperatorSpecification(r);t.push(i)}}},820:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.streamParser=void 0;const n=r(970),o=r(494),i=r(796),s=r(66),a=/([A-Za-z0-9])/g,c=/^([A-Za-z0-9])\s*=\s*(\S+)\s*$/,u=/^(\s+)/;t.streamParser={match:()=>!0,run:(e,{content:t,allValues:r})=>{const[l,...f]=e,[h,d]=(e=>{const t=c.exec(e);if(null!=t){const[,e,r]=t;return[e,r]}return[null,e]})(l),p=s.parseConfig(f,!0),b=((e,t,r)=>{const n={};for(const o of function*(e){let t;for(;null!=(t=a.exec(e));)yield t[1]}(e))n[o]=i.firstNonNull(t[o],r[o],o);return n})(d,p.values,r),_=n.parseMarbles(d,b),y=u.exec(d),m=null!=y?y[0].length:0;if(null!=h)r[h]=_;else{const e=o.createStreamSpecification(_,p.title,m);t.push(e)}}}},210:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stylesParser=void 0;const n=r(822),o=r(66);t.stylesParser={match:e=>e===n.STYLES_HEADER,run:(e,{styles:t})=>{const r=o.parseConfig(e.slice(1),!1);Object.assign(t,r)}}},940:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDiagramSpecification=void 0,t.createDiagramSpecification=(e,t)=>({content:e,styles:t})},706:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createOperatorSpecification=void 0,t.createOperatorSpecification=e=>({kind:"O",title:e})},494:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createStreamSpecification=void 0;const n=r(822),o=e=>{let t=0;const r=(e,n)=>{for(const{frame:o,notification:i}of e){const e=n+o;"value"in i&&Array.isArray(i.value)?r(i.value,e):e>t&&(t=e)}};return r(e,0),t},i=({frame:e,notification:{kind:r,value:o}})=>{const i=e*n.SCALE;switch(!0){case"C"===r:case"E"===r:return{frame:i,notification:{kind:r}};case Array.isArray(o):return{frame:i,notification:{kind:"N",value:t.createStreamSpecification(o)}};default:return{frame:i,notification:{kind:"N",value:null!=o?""+o:""}}}};t.createStreamSpecification=(e,t=null,r=0)=>{const n=e.map(i);for(const e of n)e.frame-=r;return{kind:"S",title:t,frame:r,duration:o(n),messages:n}}},282:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.byBlock=void 0;const n=r(634),o=/^\s*%/,i=e=>o.test(e);t.byBlock=function*(e){const t=[];for(const r of n.byLine(e))i(r)||(""===r.trim()?t.length>0&&(yield t.slice(),t.length=0):t.push(r));t.length>0&&(yield t)}},634:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.byLine=void 0;const r=e=>e.endsWith("\r")?e.substring(0,e.length-1):e;t.byLine=function*(e){let t=-1,n=e.indexOf("\n");for(;n>=0;)yield r(e.substring(t+1,n)),t=n,n=e.indexOf("\n",n+1);const o=r(e.substring(t+1));""!==o&&(yield o)}},796:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.firstNonNull=void 0,t.firstNonNull=(...e)=>{for(const t of e)if(null!=t)return t;return null}},969:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNumeric=void 0;const r=/^[-+]?(?:\d+|\d*(?:\.\d+))$/;t.isNumeric=e=>r.test(e)},588:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderArrow=void 0;const n=r(537),o=r(449);t.renderArrow=({document:e,styles:t,streamHeight:r},i,s,a)=>{const c=r/2,u=a*t.frame_width+r,l=i.width,f=l*Math.tan(o.degreesToRadians(s/2)),h=c-f,d=c+f,p=i.fill_color,b="string"==typeof p&&""!==p,_=n.createElement(e,"g");_.appendChild(n.createElement(e,"line",{x1:0,y1:c,x2:u-(b?l:0),y2:c,stroke:i.stroke_color,"stroke-width":i.stroke_width}));const y=[`${u-l},${h}`,`${u},${c}`,`${u-l},${d}`];return _.appendChild(n.createElement(e,b?"polygon":"polyline",{points:y.join(" "),fill:b?p:"none",stroke:i.stroke_color,"stroke-width":i.stroke_width,"stroke-linecap":"square"})),{element:_,bbox:{x1:0,y1:h,x2:u,y2:d}}}},647:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderBarrierDecoration=void 0;const n=r(537),o=r(764),i=r(777);t.renderBarrierDecoration=({document:e,styles:t,bbox:r,scaleTime:s},a)=>{const{frame:c,styles:u}=a,l=o.mergeStyles(t,u,"barrier_"),f=s(c)*t.frame_width-l.stroke_width/2,h=r.y1,d=r.y2-r.y1,p=n.createElement(e,"line",{x1:0,y1:0,x2:0,y2:d,stroke:l.color,"stroke-width":l.stroke_width,"stroke-dasharray":l.stroke_dash_width});return i.translate(p,f,h),{element:p}}},235:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderDecoration=void 0;const n=r(647),o=r(869),i={barrier:n.renderBarrierDecoration,range:o.renderRangeDecoration};t.renderDecoration=(e,t)=>(0,i[t.kind])(e,t)},869:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderRangeDecoration=void 0;const n=r(537),o=r(764),i=r(777);t.renderRangeDecoration=({document:e,styles:t,streamHeight:r,scaleTime:s},a)=>{const{frame:c,duration:u,styles:l}=a,f=o.mergeStyles(t,l,"range_"),h=s(c)*t.frame_width,d=(r-f.height)/2,p=s(u)*t.frame_width,b=f.height,_=n.createElement(e,"rect",{x:0,y:0,width:p,height:b,fill:f.fill_color,stroke:f.stroke_color,"stroke-width":f.stroke_width});return i.translate(_,h,d),{element:_}}},96:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderMarbleDiagram=void 0;const n=r(26),o=r(643),i=r(631),s=r(537),a=r(777),c=e=>"O"===e.kind;t.renderMarbleDiagram=(e,t={})=>{const r=(new(null!=t.DOMParser?t.DOMParser:DOMParser)).parseFromString('<svg xmlns="http://www.w3.org/2000/svg"/>',"image/svg+xml"),u=r.documentElement,l={...n.styles,...t.styles,...e.styles},f=s.createElement(r,"g");a.translate(f,l.canvas_padding,l.canvas_padding),u.appendChild(f);const h={document:r,styles:l,streamHeight:Math.max(2*l.event_radius,l.completion_height,l.error_size),streamTitleEnabled:e.content.some((e=>(e=>!c(e))(e)&&null!=e.title&&""!==e.title))},d=[];let p=0,b=0;for(const t of e.content){const e=c(t)?o.renderOperator(h,t):i.renderStream(h,t),{element:r,bbox:n,update:s}=e;a.translate(r,0,b-n.y1),f.appendChild(r),p=Math.max(p,n.x2),b+=n.y2-n.y1+l.stream_spacing,null!=s&&d.push(s)}b-=l.stream_spacing;const _=l.canvas_padding+p+l.canvas_padding,y=l.canvas_padding+b+l.canvas_padding;u.setAttribute("viewBox",`0 0 ${_} ${y}`),u.setAttribute("width",""+_),u.setAttribute("height",""+y);const m=l.background_color;if(""!==m&&"transparent"!==m){const e=s.createElement(r,"rect",{x:0,y:0,width:""+_,height:""+y,fill:m});u.insertBefore(e,u.firstChild)}for(const e of d)e({width:p,height:b});return{document:r,width:_,height:y}}},754:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.completeMessageRenderer=void 0;const n=r(537),o=r(764),i=r(79),s=r(777);t.completeMessageRenderer={supports:({notification:{kind:e}})=>i.NotificationKind.COMPLETE.equals(e),render:({document:e,styles:t,streamHeight:r},i)=>{const a=o.mergeStyles(t,i.styles,"completion_"),c=i.frame*t.frame_width-a.stroke_width/2,u=(r-a.height)/2,l=u+a.height,f=n.createElement(e,"g");return s.translate(f,c,0),f.appendChild(n.createElement(e,"line",{x1:0,y1:u,x2:0,y2:l,stroke:a.stroke_color,"stroke-width":a.stroke_width})),{element:f,bbox:{x1:c-a.stroke_width/2,y1:u,x2:c+a.stroke_width/2,y2:l}}}}},422:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorMessageRenderer=void 0;const n=r(537),o=r(764),i=r(79),s=r(777);t.errorMessageRenderer={supports:({notification:{kind:e}})=>i.NotificationKind.ERROR.equals(e),render:({document:e,styles:t,streamHeight:r},i)=>{const a=o.mergeStyles(t,i.styles,"error_"),c=i.frame*t.frame_width-a.size/2,u=(r-a.size)/2,l=n.createElement(e,"g");return s.translate(l,c,u),l.appendChild(n.createElement(e,"line",{x1:0,y1:0,x2:a.size,y2:a.size,stroke:a.color,"stroke-width":a.stroke_width})),l.appendChild(n.createElement(e,"line",{x1:a.size,y1:0,x2:0,y2:a.size,stroke:a.color,"stroke-width":a.stroke_width})),{element:l,bbox:{x1:c,y1:u,x2:c+a.size,y2:u+a.size}}}}},661:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderMessage=void 0;const n=r(749),o=r(951);t.renderMessage=(e,t,r)=>(o.streamMessageRenderer.supports(t)?o.streamMessageRenderer:n.nonStreamMessageRenderer).render(e,t,r)},749:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nonStreamMessageRenderer=void 0;const n=r(754),o=r(422),i=r(606),s=[n.completeMessageRenderer,o.errorMessageRenderer,i.scalarMessageRenderer];t.nonStreamMessageRenderer={supports:({notification:e})=>!("value"in e)||"object"!=typeof e.value,render:(e,t,r)=>s.find((e=>e.supports(t))).render(e,t,r)}},606:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scalarMessageRenderer=void 0;const n=r(537),o=r(764),i=r(719),s=r(777),a={auto:"light",auto_light:"light",auto_dark:"dark"};t.scalarMessageRenderer={supports:()=>!0,render:({document:e,styles:t,streamHeight:r},c,{valueAngle:u})=>{const l=o.mergeStyles(t,c.styles,"event_"),{value:f}=c.notification,h=c.frame*t.frame_width-t.event_radius,d=n.createElement(e,"g");s.translate(d,h,0);const p=a[l.fill_color],b=null!=p?i.stringToColor(f,p):l.fill_color;d.appendChild(n.createElement(e,"ellipse",{cx:t.event_radius,cy:r/2,rx:t.event_radius-l.stroke_width/2,ry:t.event_radius-l.stroke_width/2,fill:b,stroke:l.stroke_color,"stroke-width":l.stroke_width}));const _=n.createElement(e,"text",{x:0,y:0,fill:l.value_color,"font-family":l.value_font_family,"font-size":l.value_font_size+"px","font-weight":l.value_font_weight,"font-style":l.value_font_style,"dominant-baseline":"middle","text-anchor":"middle"},f);return s.translate(_,t.event_radius,r/2),s.rotate(_,u,0,0),d.appendChild(_),{element:d,bbox:{x1:h,y1:0,x2:h+2*t.event_radius,y2:r}}}}},951:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.streamMessageRenderer=void 0;const n=r(783),o=r(449),i=r(590),s=r(777),a=r(749),c=n.createRenderStream(a.nonStreamMessageRenderer.render);t.streamMessageRenderer={supports:e=>!a.nonStreamMessageRenderer.supports(e),render:(e,{frame:t,notification:r},{verticalOffset:n})=>{const{styles:a,streamHeight:u}=e,{value:l}=r,f=t*a.frame_width,h=u/2+n,{element:d,bbox:p}=c(e,!0,l);s.rotate(d,a.higher_order_angle,f,h),s.translate(d,f,0);const b=i.rotateRectangle(p,o.degreesToRadians(a.higher_order_angle),0,h);return{element:d,bbox:i.translateRectangle(b,f,0)}}}},643:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderOperator=void 0;const n=r(537),o=r(764);t.renderOperator=(e,t)=>{const{document:r,styles:i}=e,s=o.mergeStyles(i,t.styles,"operator_"),a=n.createElement(r,"g"),c=n.createElement(r,"rect",{x:0,y:s.spacing,width:1,height:s.height-s.stroke_width,fill:s.fill_color,stroke:s.stroke_color,"stroke-width":s.stroke_width,rx:s.corner_radius});a.appendChild(c);const u=n.createElement(r,"text",{x:s.spacing,y:s.spacing+s.height/2+"px",fill:s.title_color,"font-family":s.title_font_family,"font-size":s.title_font_size+"px","font-weight":s.title_font_weight,"font-style":s.title_font_style,"dominant-baseline":"middle","text-anchor":"middle"},t.title);return a.appendChild(u),{element:a,bbox:{x1:0,y1:0,x2:1,y2:s.height+2*s.spacing},update:({width:e})=>{c.setAttribute("width",""+e),u.setAttribute("x",""+e/2),u.setAttribute("width",""+e)}}}},783:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRenderStream=void 0;const n=r(588),o=r(235),i=r(537),s=r(449),a=r(590),c=r(764),u=r(79),l=r(777),f=e=>e,h=({notification:{kind:e}})=>u.NotificationKind.NEXT.equals(e),d=(e,t,r)=>{let n=0;for(let o=0;o<t;++o)h(r[o])&&r[o].frame===e.frame&&++n;return n};t.createRenderStream=e=>(t,r,u)=>{const{document:p,styles:b}=t,_=r?(e=>{const t=1/Math.cos(s.degreesToRadians(e));return e=>e*t})(b.higher_order_angle):f,y=i.createElement(p,"g"),m=[],v=({element:e,bbox:t})=>{y.appendChild(e),m.push(t)},g=c.mergeStyles(b,u.styles,"arrow_",!0),w=_(u.duration);v(n.renderArrow(t,g,b.arrowhead_angle,w));for(let n=u.messages.length-1;n>=0;--n){const o=u.messages[n],i={...o,frame:_(o.frame)},s=(h(o)?d(o,n,u.messages):0)*b.stacking_height,a={verticalOffset:s,valueAngle:r?b.higher_order_event_value_angle:0},{element:c,bbox:f}=e(t,i,a);l.translate(c,0,s),f.y2+=s,v({element:c,bbox:f})}const x={...t,scaleTime:_,bbox:a.rectangleUnion(m)};if(null!=u.decorations)for(const e of u.decorations){const{element:t,bbox:r}=o.renderDecoration(x,e);y.appendChild(t),null!=r&&(x.bbox=a.rectangleUnion([x.bbox,r]))}return{element:y,bbox:x.bbox}}},631:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderStream=void 0;const n=r(661),o=r(783),i=r(537),s=r(764),a=r(777),c=o.createRenderStream(n.renderMessage);t.renderStream=(e,t)=>{const{document:r,styles:n,streamHeight:o,streamTitleEnabled:u}=e,l=s.mergeStyles(n,t.styles,"stream_"),f=c(e,!1,t),{element:h,bbox:d}=f;if(null!=t.frame&&t.frame>0){const e=t.frame*n.frame_width;a.translate(h,e,0),d.x1+=e,d.x2+=e}if(!u)return f;const p=i.createElement(r,"g"),b="string"==typeof t.title?t.title:"";return p.appendChild(i.createElement(r,"text",{x:0,y:o/2,fill:l.title_color,"font-family":l.title_font_family,"font-size":l.title_font_size+"px","font-weight":l.title_font_weight,"font-style":l.title_font_style,"dominant-baseline":"middle"},b)),p.appendChild(h),a.translate(h,l.title_width,0),d.x1=0,d.x2+=l.title_width,{element:p,bbox:d}}},537:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createElement=void 0,t.createElement=(e,t,r={},n="")=>{const o=e.createElementNS("http://www.w3.org/2000/svg",t);for(const[e,t]of Object.entries(r))o.setAttribute(e,""+t);return""!==n&&(o.textContent=""+n),o}},449:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.degreesToRadians=void 0,t.degreesToRadians=e=>e/180*Math.PI},590:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rectangleUnion=t.rotateRectangle=t.rotatePoint=t.translateRectangle=t.translatePoint=void 0,t.translatePoint=(e,t,r,n)=>({x:e+r,y:t+n}),t.translateRectangle=({x1:e,y1:r,x2:n,y2:o},i,s)=>{const a=t.translatePoint(e,r,i,s),c=t.translatePoint(n,o,i,s);return{x1:a.x,y1:a.y,x2:c.x,y2:c.y}},t.rotatePoint=(e,t,r,n,o)=>{const i=Math.sin(r),s=Math.cos(r);return{x:(e-=n)*s-(t-=o)*i+n,y:e*i+t*s+o}},t.rotateRectangle=({x1:e,y1:r,x2:n,y2:o},i,s,a)=>{const c=t.rotatePoint(e,r,i,s,a),u=t.rotatePoint(n,o,i,s,a);return{x1:c.x,y1:c.y,x2:u.x,y2:u.y}},t.rectangleUnion=e=>{const t=e.filter((({x1:e,y1:t,x2:r,y2:n})=>r-e!=0&&n-t!=0));if(0===t.length)throw new Error("All rectangles empty");return{x1:Math.min(...t.map((e=>e.x1))),y1:Math.min(...t.map((e=>e.y1))),x2:Math.max(...t.map((e=>e.x2))),y2:Math.max(...t.map((e=>e.y2)))}}},597:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hexToDec=void 0;const r="A".charCodeAt(0),n="0".charCodeAt(0);t.hexToDec=e=>{let t=0;e=e.toUpperCase();for(let o=0;o<e.length;++o){const i=e.charCodeAt(o);t=(t<<4)+(i>=r?i-r+10:i-n)}return t}},764:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeStyles=void 0,t.mergeStyles=(e,t,r,n=!1)=>{const o={},i=Object.keys(e).filter((e=>e.startsWith(r)));for(const s of i){const i=s.substr(r.length),a=n?s:i;o[i]=null!=t&&null!=t[a]?t[a]:e[s]}return o}},79:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationKind=void 0;class r{constructor(e){this.char=e}equals(e){return"string"==typeof e&&e.charAt(0).toUpperCase()===this.char}}t.NotificationKind=r,r.NEXT=new r("N"),r.COMPLETE=new r("C"),r.ERROR=new r("E")},719:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringToColor=void 0;const n=r(112),o=r(597);t.stringToColor=(e,t)=>{const r=n.sync(e),i=o.hexToDec(r.substr(4,4));return`hsl(${Math.round(i/65536*360)}, 60%, ${"dark"===t?20:80}%)`}},777:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rotate=t.translate=t.transform=void 0,t.transform=(e,t)=>{const r=e.getAttribute("transform"),n=(null!=r&&""!==r?r+" ":"")+t;e.setAttribute("transform",n)},t.translate=(e,r,n)=>{0===r&&0===n||t.transform(e,`translate(${r} ${n})`)},t.rotate=(e,r,n=0,o=0)=>{0!==r&&t.transform(e,`rotate(${r} ${n} ${o})`)}},516:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0,t.styles={arrow_fill_color:"",arrow_stroke_width:2,arrow_width:10,arrowhead_angle:60,barrier_stroke_dash_width:4,barrier_stroke_width:2,canvas_padding:25,completion_height:50,completion_stroke_width:2,error_size:30,error_stroke_width:2,event_radius:20,event_stroke_width:2,event_value_font_family:"Arial, Helvetica, sans-serif",event_value_font_size:18,event_value_font_style:"normal",event_value_font_weight:"normal",frame_width:30,higher_order_angle:18,higher_order_event_value_angle:0,operator_corner_radius:0,operator_stroke_width:2,operator_title_font_family:"Arial, Helvetica, sans-serif",operator_title_font_size:24,operator_title_font_style:"normal",operator_title_font_weight:"normal",operator_height:50,operator_spacing:10,range_height:15,range_stroke_width:0,stacking_height:50,stream_spacing:20,stream_title_font_family:"Arial, Helvetica, sans-serif",stream_title_font_size:18,stream_title_font_style:"normal",stream_title_font_weight:"normal",stream_title_width:100}},160:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;const n=r(516);t.styles={...n.styles,arrow_stroke_color:"white",background_color:"black",barrier_color:"rgba(255, 255, 255, 0.5)",completion_stroke_color:"white",error_color:"white",event_fill_color:"auto_dark",event_stroke_color:"white",event_value_color:"white",operator_fill_color:"black",operator_stroke_color:"white",operator_title_color:"white",range_fill_color:"rgba(159, 159, 159, 0.25)",range_stroke_color:"white",stream_title_color:"white"}},26:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;const n=r(516);t.styles={...n.styles,arrow_stroke_color:"black",background_color:"white",barrier_color:"rgba(0, 0, 0, 0.5)",completion_stroke_color:"black",error_color:"black",event_fill_color:"auto_light",event_stroke_color:"black",event_value_color:"black",operator_fill_color:"white",operator_stroke_color:"black",operator_title_color:"black",range_fill_color:"rgba(95, 95, 95, 0.25)",range_stroke_color:"black",stream_title_color:"black"}},97:(e,t,r)=>{"use strict";const n=r(697),o=r(96),i=r(160),s=r(26);t.default=class{constructor(e){this.darkThemeEnabled=!1,this.darkThemeEnabled=e??!1}parse(e){try{return n.parseMarbleDiagramSpecification(e)}catch(e){return void console.log("Failed to parse: "+e.stack)}}render(e){const t=this.darkThemeEnabled?i.styles:s.styles;try{return o.renderMarbleDiagram(e,{styles:t})}catch(e){return void console.log("Failed to render: "+e.stack)}}drawSVG(e,t){const r=t.document.documentElement;e.innerHTML="",e.appendChild(r)}}}},t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}return r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(97)})().default}));